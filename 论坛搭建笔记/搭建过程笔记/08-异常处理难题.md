# 08-异常处理难题
1.[资源控制器](d.laravel-china.org/docs/5.5/controllers.html#资源控制器)

2.给不同的页面设置访问权限，如未注册登陆的用户不应该访问到添加话题或评论的表单：可以在ThreadsController的构造函数中添加`$this->middleware('auth')->only(['create','store']);`，这样未注册的用户将不能访问/threads/create以及/threads/store页面，当然也能使用except来排除可以访问的页面：`$this->middleware('auth')->except(['index','show']);`。

3.前面在测试`guests_may_not_create_threads`的时候，仅仅期望接收到`Illuminate\Auth\AuthenticationException: Unauthenticated.`异常，所以去Handle中的render方法中开启了抛出异常功能；

而现在在测试`guest_cannot_see_the_create_thread_page`的时候，还要检测它是否跳转到注册页面，而如果像前面一样使用expectException的话，会导致直接跳过后面的assertRedirect，出现这个原因是因为Laravel catches exceptions and turns them into error pages for you, which means the exceptions never hit PHPUnit itself.这不是我们想要的结果

adamwathan写了一个针对Laravel的异常测试：[Gist](https://gist.github.com/adamwathan/125847c7e3f16b88fa33a9f8b42333da)
把他写的TestCase复制到tests/TestCase.php中，当接受异常之后还要检查其他assert的时候调用`withExceptionHandling`即可。


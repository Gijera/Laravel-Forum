# 06-用户可以添加话题
1.`$this->be()`登陆用户的语法糖

```
$this->actingAs(factory('App\User')->create());
```

2.create、make、raw生成数据

3.[限制路由访问](d.laravel-china.org/docs/5.4/authentication.html#限制路由访问)

```
//出现错误
Illuminate\Database\QueryException: SQLSTATE[23000]: Integrity constraint violation: 19 NOT NULL constraint failed: threads.user_id (SQL: insert into "threads" ("user_id", "title", "body", "updated_at", "created_at") values (, Nostrum qui dolorum saepe sed qui odit alias., Asperiores est sit et. A architecto ratione non minus quo reiciendis.

Caused by
PDOException: SQLSTATE[23000]: Integrity constraint violation: 19 NOT NULL constraint failed: threads.user_id

//在相应的控制器中的构造函数里添加auth中间件
```

### Laravel用户认证
在Laravel5.4中，只需一条命令`php artisan make:auth`即可完成所有的用户功能的创建、登录、注册以及认证，论坛中直接应用了它，所以现在是时候来稍微了解一下它，参考[Laravel的用户认证系统](d.laravel-china.org/docs/5.4/authentication.html#Laravel-的用户认证系统)

#### 控制器
* RegisterController 用户注册
* LoginController 用户认证
* ForgotPasswordController、ResetPasswordController 重置密码
* HomeController 登陆成功后跳转到该控制器下

#### 路由
* Route::get('/home', 'HomeController@index')->name('home');

#### 视图
* auth(login register)
* layouts(app)
* home

#### 用法
1.通过Auth facade来访问认证的用户

```
use Illuminate\Support\Facades\Auth;

// 获取当前已通过认证的用户...
$user = Auth::user();

// 获取当前已通过认证的用户id...
$id = Auth::id();
```
2.检查用户是否登陆

```
use Illuminate\Support\Facades\Auth;

if (Auth::check()) {
    // 这个用户已经登录...
}
```
3.查找数据库里的用户数据

```
Auth::attempt(['email' => $email, 'password' => $password])
```


